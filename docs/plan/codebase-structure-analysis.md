# ä»£ç åº“ç»“æ„åˆ†æ - è°ƒç”¨å…³ç³»å›¾åŠŸèƒ½æ¶æ„è®¾è®¡

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

ä¸ºKodeé¡¹ç›®æä¾›æ™ºèƒ½ä»£ç åº“ç»“æ„åˆ†æåŠŸèƒ½ï¼Œé€šè¿‡é™æ€ä»£ç åˆ†ææå–å‡½æ•°/æ–¹æ³•ã€å˜é‡ã€ç±»ç­‰çš„è°ƒç”¨å…³ç³»ï¼Œæ„å»ºå›¾ç»“æ„å¹¶å­˜å‚¨åˆ°Neo4jå›¾æ•°æ®åº“ã€‚åŸºäºKiloCodeè®¾è®¡æ€æƒ³ï¼Œå·²é›†æˆæ™ºèƒ½è¯­æ³•è§£æã€å¤šåµŒå…¥å™¨æ”¯æŒå’Œå…¨æ–¹ä½ç›‘æ§ä½“ç³»ã€‚

**ğŸš€ æ¶æ„å¢å¼º**: åŸºäºKiloCodeè®¾è®¡æ€æƒ³ï¼Œå·²é›†æˆæ™ºèƒ½è¯­æ³•è§£æã€å¤šåµŒå…¥å™¨æ”¯æŒã€è·¯å¾„æ®µç´¢å¼•ã€å¢é‡å®æ—¶ç´¢å¼•å’Œå…¨æ–¹ä½ç›‘æ§ä½“ç³»ã€‚

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ ¸å¿ƒç»„ä»¶

#### 1. æ™ºèƒ½ä»£ç è§£æå™¨ (Smart Code Parser)
- **èŒè´£**: è§£ææºä»£ç æ–‡ä»¶ï¼Œæå–ä»£ç å®ä½“å’Œè°ƒç”¨å…³ç³»
- **æŠ€æœ¯é€‰æ‹©**: Tree-sitterå¤šè¯­è¨€è¯­æ³•è§£æå™¨ + ASTåˆ†æ
- **åŠŸèƒ½**: 
  - å¤šè¯­è¨€æ”¯æŒï¼ˆTypeScriptã€JavaScriptã€Pythonã€Javaã€Goã€Rustã€C/C++ï¼‰
  - è¯­æ³•æ„ŸçŸ¥åˆ†å—å’Œæ™ºèƒ½å…ƒæ•°æ®æå–
  - å“ˆå¸Œå»é‡å’Œå†…å®¹ç¼“å­˜æœºåˆ¶
  - è§„åˆ™å¼•æ“é›†æˆå’Œè¯­è¨€ç‰¹å®šæ¨¡å¼è¯†åˆ«
- **è¾“å‡º**: ç»“æ„åŒ–ä»£ç å®ä½“å’Œå…³ç³»æ•°æ®

#### 2. å›¾æ„å»ºå™¨ (Graph Builder) 
- **èŒè´£**: å°†è§£æç»“æœè½¬æ¢ä¸ºå›¾ç»“æ„æ•°æ®
- **åŠŸèƒ½**: 
  - å®ä½“å»é‡å’Œå…³ç³»è§„èŒƒåŒ–
  - å›¾ç»“æ„ä¼˜åŒ–å’Œç´¢å¼•åˆ›å»º
  - æ‰¹é‡æ•°æ®å¤„ç†å’Œæ€§èƒ½ä¼˜åŒ–
  - è·¯å¾„æ®µç´¢å¼•å’Œç›®å½•çº§è¿‡æ»¤
- **è¾“å‡º**: Neo4jå…¼å®¹çš„CypheræŸ¥è¯¢è¯­å¥

#### 3. å¤šåµŒå…¥å™¨å¢å¼ºæœåŠ¡ (Multi-Embedder Enhancement Service)
- **èŒè´£**: ä¸ºå›¾èŠ‚ç‚¹æä¾›è¯­ä¹‰å‘é‡åŒ–æ”¯æŒ
- **æŠ€æœ¯é€‰æ‹©**: ç»Ÿä¸€åµŒå…¥å™¨æ¥å£ï¼Œæ”¯æŒOpenAIã€Ollamaã€Geminiã€Mistral
- **åŠŸèƒ½**: 
  - ä»£ç è¯­ä¹‰å‘é‡åŒ–
  - æ¨¡å‹ç»´åº¦è‡ªåŠ¨é€‚é…
  - æ‰¹å¤„ç†å’Œç¼“å­˜ä¼˜åŒ–
  - æŸ¥è¯¢å‰ç¼€å¤„ç†
- **è¾“å‡º**: è¯­ä¹‰å‘é‡ç”¨äºå¢å¼ºæœç´¢å’Œåˆ†æ

#### 4. Neo4jè¿æ¥å™¨ (Neo4j Connector)
- **èŒè´£**: ç®¡ç†ä¸Neo4jæ•°æ®åº“çš„è¿æ¥å’Œæ•°æ®æ“ä½œ
- **æŠ€æœ¯é€‰æ‹©**: Neo4j JavaScriptå®˜æ–¹é©±åŠ¨
- **åŠŸèƒ½**: 
  - æ‰¹é‡å¯¼å…¥å’ŒæŸ¥è¯¢ä¼˜åŒ–
  - è¿æ¥æ± ç®¡ç†å’Œäº‹åŠ¡å¤„ç†
  - é”™è¯¯æ¢å¤å’Œé‡è¯•æœºåˆ¶
  - æ€§èƒ½ç›‘æ§å’Œå¥åº·æ£€æŸ¥

#### 5. æŸ¥è¯¢æœåŠ¡ (Query Service)
- **èŒè´£**: æä¾›å›¾ç»“æ„æŸ¥è¯¢æ¥å£
- **åŠŸèƒ½**: 
  - è·¯å¾„æŸ¥è¯¢å’Œå…³ç³»åˆ†æ
  - è¯­ä¹‰æœç´¢å¢å¼º
  - å¯è§†åŒ–æ•°æ®å¯¼å‡º
  - å½±å“èŒƒå›´åˆ†æå’Œä¾èµ–è¿½è¸ª

#### 6. ç›‘æ§å’Œé”™è¯¯å¤„ç†æœåŠ¡ (Monitoring & Error Handling Service)
- **èŒè´£**: å…¨æ–¹ä½ç³»ç»Ÿç›‘æ§å’Œæ™ºèƒ½é”™è¯¯å¤„ç†
- **æŠ€æœ¯é€‰æ‹©**: Prometheus + Winston + è‡ªå®šä¹‰é”™è¯¯å¤„ç†æ¡†æ¶
- **åŠŸèƒ½**: 
  - æ€§èƒ½æŒ‡æ ‡æ”¶é›†å’Œæš´éœ²
  - æ™ºèƒ½é”™è¯¯åˆ†ç±»å’Œè‡ªåŠ¨é‡è¯•
  - å¥åº·æ£€æŸ¥å’Œå°±ç»ªæ¢é’ˆ
  - è­¦æŠ¥ç³»ç»Ÿå’Œé€šçŸ¥æœºåˆ¶

### æ•°æ®æ¨¡å‹

#### èŠ‚ç‚¹ç±»å‹ (Node Labels)
- `Function` - å‡½æ•°/æ–¹æ³•
- `Class` - ç±»/æ¥å£  
- `Variable` - å˜é‡/å¸¸é‡
- `File` - æºä»£ç æ–‡ä»¶
- `Module` - æ¨¡å—/åŒ…
- `Package` - åŒ…/ä¾èµ–é¡¹
- `Interface` - æ¥å£å®šä¹‰
- `Enum` - æšä¸¾ç±»å‹
- `TypeAlias` - ç±»å‹åˆ«å

#### å…³ç³»ç±»å‹ (Relationship Types)
- `CALLS` - å‡½æ•°è°ƒç”¨å…³ç³»
- `EXTENDS` - ç±»ç»§æ‰¿å…³ç³»
- `IMPLEMENTS` - æ¥å£å®ç°å…³ç³»  
- `REFERENCES` - å˜é‡å¼•ç”¨å…³ç³»
- `CONTAINS` - æ–‡ä»¶åŒ…å«å…³ç³»
- `IMPORTS` - æ¨¡å—å¯¼å…¥å…³ç³»
- `EXPORTS` - æ¨¡å—å¯¼å‡ºå…³ç³»
- `TYPE_DEPENDS_ON` - ç±»å‹ä¾èµ–å…³ç³»
- `OVERRIDES` - æ–¹æ³•é‡å†™å…³ç³»
- `USES` - ä½¿ç”¨å…³ç³»

#### å¢å¼ºå±æ€§ç»“æ„
```typescript
interface GraphNode {
  id: string
  labels: string[]
  properties: {
    name: string
    type: string
    filePath: string
    language: string
    startLine?: number
    endLine?: number
    visibility?: 'public' | 'private' | 'protected'
    isAsync?: boolean
    isStatic?: boolean
    isAbstract?: boolean
    parameters?: string[]
    returnType?: string
    vector?: number[]  // è¯­ä¹‰å‘é‡
    hash?: string      // å†…å®¹å“ˆå¸Œ
    metadata?: Record<string, any>
  }
}

interface GraphRelationship {
  id: string
  type: string
  startNodeId: string
  endNodeId: string
  properties: {
    weight?: number
    context?: string
    callCount?: number
    lineNumbers?: number[]
    vector?: number[]  // å…³ç³»è¯­ä¹‰å‘é‡
    metadata?: Record<string, any>
  }
}
```

### æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯é€‰æ‹© | ç‰ˆæœ¬ | åŠŸèƒ½ |
|------|----------|------|------|
| å›¾æ•°æ®åº“ | Neo4j | 5.x | ç”Ÿäº§çº§å›¾æ•°æ®åº“ï¼Œæ”¯æŒCypheræŸ¥è¯¢ |
| å‘é‡æ•°æ®åº“ | Qdrant | 1.x | è¯­ä¹‰å‘é‡å­˜å‚¨å’Œæœç´¢ |
| æ•°æ®åº“é©±åŠ¨ | neo4j-driver | 5.x | Neo4jå®˜æ–¹JavaScripté©±åŠ¨ |
| å‘é‡å®¢æˆ·ç«¯ | qdrant-client | 1.x | Qdrantå®˜æ–¹JavaScriptå®¢æˆ·ç«¯ |
| æ™ºèƒ½è§£æ | Tree-sitter | 0.20.x | å¤šè¯­è¨€è¯­æ³•è§£æå™¨ |
| è¯­è¨€è§£æå™¨ | @tree-sitter/* | 0.20.x | TypeScriptã€JavaScriptã€Pythonã€Javaã€Goã€Rustã€C/C++ã€Markdown |
| å¤šåµŒå…¥å™¨æ”¯æŒ | OpenAI/Ollama/Gemini/Mistral | æœ€æ–°ç‰ˆ | ç»Ÿä¸€åµŒå…¥å™¨æ¥å£ï¼Œæ”¯æŒå¤šç§æä¾›å•† |
| æ–‡ä»¶ç›‘è§† | Chokidar | 3.5.x | é«˜æ€§èƒ½æ–‡ä»¶ç³»ç»Ÿç›‘è§† |
| ç›‘æ§ç³»ç»Ÿ | Prometheus + Winston | 0.20.x / 3.10.x | æ€§èƒ½æŒ‡æ ‡æ”¶é›†å’Œç»“æ„åŒ–æ—¥å¿— |
| é”™è¯¯å¤„ç† | p-retry + è‡ªå®šä¹‰æ¡†æ¶ | 6.x | æ™ºèƒ½é‡è¯•å’Œé”™è¯¯åˆ†ç±» |
| MCPåè®® | @modelcontextprotocol/server | 1.x | Model Context ProtocolæœåŠ¡ç«¯ |
| å·¥å…·åº“ | crypto/fs-extra/p-limit | æœ€æ–°ç‰ˆ | å“ˆå¸Œã€æ–‡ä»¶æ“ä½œã€å¹¶å‘æ§åˆ¶ |

#### åµŒå…¥æ¨¡å‹æ”¯æŒ
- **OpenAI**: text-embedding-ada-002ã€text-embedding-3-smallã€text-embedding-3-large
- **Ollama**: nomic-embed-textã€nomic-embed-codeã€mxbai-embed-large
- **Gemini**: text-embedding-004ã€gemini-embedding-001
- **Mistral**: codestral-embed-2505
- **è‡ªåŠ¨ç»´åº¦é€‚é…**: æ ¹æ®é€‰æ‹©çš„æ¨¡å‹è‡ªåŠ¨è°ƒæ•´å‘é‡å­˜å‚¨ç»´åº¦

#### å¤šè¯­è¨€æ”¯æŒ
- **TypeScript/JavaScript**: åŸç”Ÿæ”¯æŒï¼Œå®Œæ•´çš„ASTè§£æ
- **Python**: Tree-sitterè§£æå™¨ï¼Œæ”¯æŒå‡½æ•°ã€ç±»ã€æ¨¡å—åˆ†æ
- **Java**: Tree-sitterè§£æå™¨ï¼Œæ”¯æŒç±»ã€æ¥å£ã€æ–¹æ³•åˆ†æ
- **Go**: Tree-sitterè§£æå™¨ï¼Œæ”¯æŒç»“æ„ä½“ã€æ¥å£ã€å‡½æ•°åˆ†æ
- **Rust**: Tree-sitterè§£æå™¨ï¼Œæ”¯æŒç»“æ„ä½“ã€traitã€å‡½æ•°åˆ†æ
- **C/C++**: Tree-sitterè§£æå™¨ï¼Œæ”¯æŒå‡½æ•°ã€ç±»ã€å‘½åç©ºé—´åˆ†æ
- **Markdown**: Tree-sitterè§£æå™¨ï¼Œæ”¯æŒæ–‡æ¡£ç»“æ„åˆ†æ

## ğŸ”„ å·¥ä½œæµç¨‹

### 1. æ™ºèƒ½ä»£ç åˆ†æé˜¶æ®µ
```
æºä»£ç æ–‡ä»¶ â†’ Tree-sitterè§£æ â†’ è¯­æ³•æ„ŸçŸ¥åˆ†å— â†’ æ™ºèƒ½å®ä½“æå– â†’ å…³ç³»è¯†åˆ« â†’ å›¾æ•°æ®ç”Ÿæˆ
```

### 2. è¯­ä¹‰å¢å¼ºé˜¶æ®µ
```
å›¾æ•°æ® â†’ å¤šåµŒå…¥å™¨å‘é‡åŒ– â†’ è¯­ä¹‰å‘é‡ç”Ÿæˆ â†’ å‘é‡å­˜å‚¨(Qdrant) â†’ å›¾å‘é‡å…³è”
```

### 3. æ•°æ®å­˜å‚¨é˜¶æ®µ  
```
å›¾æ•°æ® â†’ CypheræŸ¥è¯¢ç”Ÿæˆ â†’ æ‰¹é‡å¯¼å…¥Neo4j â†’ ç´¢å¼•æ„å»º â†’ è·¯å¾„æ®µç´¢å¼•
```

### 4. å¢é‡æ›´æ–°é˜¶æ®µ
```
æ–‡ä»¶å˜æ›´ â†’ ç›‘è§†å™¨æ£€æµ‹ â†’ å“ˆå¸Œæ¯”å¯¹ â†’ å¢é‡è§£æ â†’ å·®å¼‚æ›´æ–° â†’ å®æ—¶åŒæ­¥
```

### 5. æ™ºèƒ½æŸ¥è¯¢æœåŠ¡é˜¶æ®µ
```
ç”¨æˆ·æŸ¥è¯¢ â†’ æŸ¥è¯¢åˆ†æ â†’ å¹¶è¡Œæ‰§è¡Œ(è¯­ä¹‰æœç´¢+å›¾å…³ç³»æŸ¥è¯¢) â†’ æ™ºèƒ½ç»“æœèåˆ â†’ ç›¸å…³æ€§é‡æ’ â†’ å¯è§†åŒ–è¾“å‡º
```

#### æŸ¥è¯¢åè°ƒç­–ç•¥
```typescript
class QueryCoordinationService {
  async executeEnhancedSearch(query: string): Promise<EnhancedSearchResult[]> {
    // å¹¶è¡Œæ‰§è¡ŒæŸ¥è¯¢ä»¥æé«˜æ€§èƒ½
    const [semanticResults, graphResults] = await Promise.all([
      this.qdrantService.semanticSearch(query),
      this.neo4jService.graphQuery(query)
    ]);
    
    // æ™ºèƒ½ç»“æœèåˆ
    const fusedResults = await this.fusionEngine.combineResults(
      semanticResults, 
      graphResults,
      {
        semanticWeight: 0.6,    // è¯­ä¹‰æœç´¢æƒé‡
        graphWeight: 0.4,        // å›¾å…³ç³»æƒé‡
        contextBoost: 1.2       // ä¸Šä¸‹æ–‡å¢å¼ºå› å­
      }
    );
    
    return fusedResults;
  }
}
```

#### ç»“æœèåˆç®—æ³•
```typescript
class FusionEngine {
  combineResults(
    semanticResults: SearchResult[],
    graphResults: GraphResult[],
    weights: FusionWeights
  ): EnhancedSearchResult[] {
    // åŸºäºå®ä½“IDè¿›è¡Œç»“æœåŒ¹é…
    const entityMap = new Map<string, EnhancedResult>();
    
    // å¤„ç†è¯­ä¹‰æœç´¢ç»“æœ
    semanticResults.forEach(result => {
      entityMap.set(result.entityId, {
        ...result,
        semanticScore: result.score,
        graphScore: 0,
        finalScore: result.score * weights.semanticWeight
      });
    });
    
    // èåˆå›¾å…³ç³»ç»“æœ
    graphResults.forEach(result => {
      const existing = entityMap.get(result.entityId);
      if (existing) {
        // å·²å­˜åœ¨å®ä½“ï¼Œå¢å¼ºè¯„åˆ†
        existing.graphScore = result.score;
        existing.finalScore += result.score * weights.graphWeight;
        existing.relatedEntities = result.relatedEntities;
      } else {
        // æ–°å®ä½“ï¼Œæ·»åŠ åˆ°ç»“æœé›†
        entityMap.set(result.entityId, {
          ...result,
          semanticScore: 0,
          graphScore: result.score,
          finalScore: result.score * weights.graphWeight
        });
      }
    });
    
    // åº”ç”¨ä¸Šä¸‹æ–‡å¢å¼º
    return this.applyContextBoost(Array.from(entityMap.values()), weights);
  }
}
```

### 6. ç›‘æ§å’Œé”™è¯¯å¤„ç†é˜¶æ®µ
```
æ€§èƒ½æŒ‡æ ‡æ”¶é›† â†’ é”™è¯¯åˆ†ç±» â†’ æ™ºèƒ½é‡è¯• â†’ å¥åº·æ£€æŸ¥ â†’ è­¦æŠ¥é€šçŸ¥ â†’ ç³»ç»Ÿè‡ªæ„ˆ
```

## ğŸ“Š é›†æˆæ–¹æ¡ˆ

### ä¸å¢å¼ºæ¶æ„é›†æˆ

#### æœåŠ¡å±‚æ‰©å±•
```typescript
// æ™ºèƒ½å›¾åˆ†ææœåŠ¡æ¨¡å—
src/services/graph/
â”œâ”€â”€ GraphAnalysisService.ts    # ä¸»å›¾åˆ†ææœåŠ¡
â”œâ”€â”€ Neo4jConnector.ts          # Neo4jè¿æ¥ç®¡ç†
â”œâ”€â”€ SmartCodeParser.ts         # æ™ºèƒ½ä»£ç è§£æå™¨
â”œâ”€â”€ GraphBuilder.ts            # å›¾æ„å»ºå™¨
â”œâ”€â”€ SemanticEnhancer.ts        # è¯­ä¹‰å¢å¼ºæœåŠ¡
â”œâ”€â”€ PathIndexManager.ts        # è·¯å¾„æ®µç´¢å¼•ç®¡ç†
â””â”€â”€ GraphQueryService.ts       # å›¾æŸ¥è¯¢æœåŠ¡

// æŸ¥è¯¢åè°ƒæœåŠ¡æ¨¡å—
src/services/coordination/
â”œâ”€â”€ QueryCoordinationService.ts    # æŸ¥è¯¢åè°ƒæœåŠ¡
â”œâ”€â”€ FusionEngine.ts                 # ç»“æœèåˆå¼•æ“
â”œâ”€â”€ QueryOptimizer.ts              # æŸ¥è¯¢ä¼˜åŒ–å™¨
â”œâ”€â”€ CacheManager.ts                # ç¼“å­˜ç®¡ç†å™¨
â””â”€â”€ PerformanceAnalyzer.ts         # æ€§èƒ½åˆ†æå™¨

// è·¨æ•°æ®åº“åŒæ­¥æœåŠ¡æ¨¡å—
src/services/sync/
â”œâ”€â”€ CrossDatabaseSyncService.ts    # è·¨æ•°æ®åº“åŒæ­¥æœåŠ¡
â”œâ”€â”€ EntityManager.ts               # å®ä½“ç®¡ç†å™¨
â”œâ”€â”€ ConsistencyChecker.ts          # ä¸€è‡´æ€§æ£€æŸ¥å™¨
â”œâ”€â”€ ChangePropagator.ts            # å˜æ›´ä¼ æ’­å™¨
â””â”€â”€ RecoveryManager.ts             # æ¢å¤ç®¡ç†å™¨

// å¤šåµŒå…¥å™¨æ”¯æŒ
src/embedders/
â”œâ”€â”€ EmbedderFactory.ts         # åµŒå…¥å™¨å·¥å‚
â”œâ”€â”€ OpenAiEmbedder.ts          # OpenAIåµŒå…¥å™¨
â”œâ”€â”€ OllamaEmbedder.ts           # OllamaåµŒå…¥å™¨
â”œâ”€â”€ GeminiEmbedder.ts          # GeminiåµŒå…¥å™¨
â””â”€â”€ MistralEmbedder.ts         # MistralåµŒå…¥å™¨

// ç›‘æ§å’Œé”™è¯¯å¤„ç†
src/services/monitoring/
â”œâ”€â”€ MonitoringService.ts       # ç›‘æ§æœåŠ¡
â”œâ”€â”€ MetricsCollector.ts        # æŒ‡æ ‡æ”¶é›†å™¨
â”œâ”€â”€ ErrorHandler.ts            # é”™è¯¯å¤„ç†å™¨
â”œâ”€â”€ HealthCheck.ts             # å¥åº·æ£€æŸ¥
â””â”€â”€ AlertManager.ts            # è­¦æŠ¥ç®¡ç†å™¨
```

#### MCPå·¥å…·æ¥å£
```typescript
// MCPå·¥å…·å®šä¹‰
interface MCPGraphTools {
  'codebase/graph/analyze': {
    input: { projectPath: string; options?: GraphAnalyzeOptions }
    output: { success: boolean; nodes: number; relationships: number; time: number }
  }
  'codebase/graph/query': {
    input: { query: string; options?: GraphQueryOptions }
    output: { results: GraphResult[]; executionTime: number }
  }
  'codebase/graph/visualize': {
    input: { type: 'call-graph' | 'dependency' | 'inheritance'; options?: VisualizeOptions }
    output: { graphData: GraphData; metadata: VisualMetadata }
  }
  'codebase/graph/enhance-search': {
    input: { query: string; options?: EnhancedSearchOptions }
    output: { results: EnhancedSearchResult[]; semanticScore: number; graphScore: number }
  }
  'codebase/graph/incremental-update': {
    input: { filePath: string; operation: 'add' | 'update' | 'delete' }
    output: { success: boolean; affectedNodes: number; updateTime: number }
  }
}
```

#### ç¯å¢ƒä¾èµ–

#### å¢å¼ºä¾èµ–é…ç½®
```json
{
  "dependencies": {
    // æ ¸å¿ƒæ•°æ®åº“
    "neo4j-driver": "^5.0.0",
    "qdrant-client": "^1.10.0",
    
    // æ™ºèƒ½è§£æ
    "tree-sitter": "^0.20.0",
    "@tree-sitter/typescript": "^0.20.0",
    "@tree-sitter/javascript": "^0.20.0",
    "@tree-sitter/python": "^0.20.0",
    "@tree-sitter/java": "^0.20.0",
    "@tree-sitter/go": "^0.20.0",
    "@tree-sitter/rust": "^0.20.0",
    "@tree-sitter/cpp": "^0.20.0",
    "@tree-sitter/markdown": "^0.20.0",
    
    // å¤šåµŒå…¥å™¨æ”¯æŒ
    "openai": "^5.15.0",
    "ollama": "^0.5.0",
    "@google/generative-ai": "^0.5.0",
    "@mistralai/mistral": "^0.5.0",
    
    // æ–‡ä»¶ç›‘è§†å’Œå¢é‡å¤„ç†
    "chokidar": "^3.5.0",
    "p-limit": "^4.0.0",
    "async-mutex": "^0.4.0",
    
    // ç›‘æ§å’Œé”™è¯¯å¤„ç†
    "prometheus-client": "^0.20.0",
    "winston": "^3.10.0",
    "p-retry": "^6.0.0",
    
    // MCPåè®®
    "@modelcontextprotocol/server": "^1.0.0",
    "@modelcontextprotocol/types": "^1.0.0",
    
    // å·¥å…·åº“
    "crypto": "^1.0.0",
    "fs-extra": "^11.0.0",
    "path": "^0.12.0"
  }
}
```

#### Dockeré…ç½®
```yaml
# docker-compose.enhanced.yml
services:
  neo4j:
    image: neo4j:5.0
    ports:
      - "7474:7474"  # Browser UI
      - "7687:7687"  # Bolt protocol
    environment:
      - NEO4J_AUTH=neo4j/password
      - NEO4J_ACCEPT_LICENSE_AGREEMENT=yes
      - NEO4J_PLUGINS=["apoc"]
    volumes:
      - neo4j_data:/data
      - neo4j_logs:/logs
      - ./neo4j/plugins:/plugins

  qdrant:
    image: qdrant/qdrant:v1.7.0
    ports:
      - "6333:6333"  # REST API
      - "6334:6334"  # gRPC API
    volumes:
      - qdrant_data:/qdrant/storage
    environment:
      - QDRANT__SERVICE__HTTP_PORT=6333
      - QDRANT__SERVICE__GRPC_PORT=6334

  prometheus:
    image: prom/prometheus:v2.45.0
    ports:
      - "9090:9090"
    volumes:
      - ./monitoring/prometheus.yml:/etc/prometheus/prometheus.yml
      - prometheus_data:/prometheus

  grafana:
    image: grafana/grafana:10.2.0
    ports:
      - "3000:3000"
    volumes:
      - grafana_data:/var/lib/grafana
      - ./monitoring/grafana:/etc/grafana/provisioning
    environment:
      - GF_SECURITY_ADMIN_PASSWORD=admin
```

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

### æ™ºèƒ½é™æ€åˆ†æèƒ½åŠ›
- **å‡½æ•°/æ–¹æ³•è°ƒç”¨é“¾åˆ†æ**: æ·±åº¦è°ƒç”¨å…³ç³»è¿½è¸ªï¼Œæ”¯æŒå¼‚æ­¥å’Œé€’å½’è°ƒç”¨
- **ç±»ç»§æ‰¿å…³ç³»è¿½è¸ª**: å¤šå±‚ç»§æ‰¿ã€æ¥å£å®ç°ã€traitç³»ç»Ÿåˆ†æ
- **å˜é‡å¼•ç”¨å…³ç³»æ˜ å°„**: å˜é‡ä½œç”¨åŸŸã€ç”Ÿå‘½å‘¨æœŸã€å¼•ç”¨è®¡æ•°åˆ†æ
- **è·¨æ–‡ä»¶ä¾èµ–åˆ†æ**: æ¨¡å—å¯¼å…¥ã€åŒ…ä¾èµ–ã€ç±»å‹å¼•ç”¨è¿½è¸ª
- **ç±»å‹ç³»ç»Ÿåˆ†æ**: æ³›å‹ã€è”åˆç±»å‹ã€ç±»å‹åˆ«åã€æ¡ä»¶ç±»å‹åˆ†æ
- **è£…é¥°å™¨å’Œæ³¨è§£å¤„ç†**: TypeScriptè£…é¥°å™¨ã€Javaæ³¨è§£ã€Pythonè£…é¥°å™¨åˆ†æ

### è¯­ä¹‰å¢å¼ºæœç´¢
- **å¤šåµŒå…¥å™¨æ”¯æŒ**: OpenAIã€Ollamaã€Geminiã€Mistralç­‰æä¾›å•†
- **è¯­ä¹‰å‘é‡å…³è”**: å›¾èŠ‚ç‚¹ä¸è¯­ä¹‰å‘é‡çš„åŒå‘å…³è”
- **æ··åˆæœç´¢æ¨¡å¼**: ç»“åˆå›¾å…³ç³»å’Œè¯­ä¹‰æœç´¢çš„æ™ºèƒ½æŸ¥è¯¢
- **ä¸Šä¸‹æ–‡æ„ŸçŸ¥æœç´¢**: åŸºäºè°ƒç”¨å…³ç³»çš„è¯­ä¹‰æœç´¢å¢å¼º
- **æ™ºèƒ½ç»“æœé‡æ’**: å¤šç»´åº¦è¯„åˆ†å’Œç›¸å…³æ€§ä¼˜åŒ–
- **æŸ¥è¯¢æ‰©å±•å’ŒåŒä¹‰è¯**: åŸºäºè¯­ä¹‰çš„æŸ¥è¯¢æ‰©å±•å’Œä¼˜åŒ–

### æ™ºèƒ½æŸ¥è¯¢åŠŸèƒ½
- **æœ€çŸ­è°ƒç”¨è·¯å¾„æŸ¥æ‰¾**: åŸºäºå›¾ç®—æ³•çš„æœ€ä¼˜è·¯å¾„åˆ†æ
- **å½±å“èŒƒå›´åˆ†æ**: ä»£ç å˜æ›´çš„å½±å“ä¼ æ’­å’Œé£é™©è¯„ä¼°
- **ä¾èµ–å…³ç³»å¯è§†åŒ–**: äº¤äº’å¼å›¾å¯è§†åŒ–å’Œå±‚æ¬¡åŒ–å±•ç¤º
- **ä»£ç å˜æ›´å½±å“è¯„ä¼°**: åŸºäºå›¾ç»“æ„çš„å˜æ›´å½±å“é¢„æµ‹
- **æ¨¡å¼åŒ¹é…æŸ¥è¯¢**: åŸºäºè§„åˆ™çš„å¤æ‚æ¨¡å¼æŸ¥è¯¢
- **æ—¶åºåˆ†æ**: ä»£ç ç»“æ„æ¼”å˜å’Œå†å²è¶‹åŠ¿åˆ†æ

### å¢é‡å®æ—¶å¤„ç†
- **æ–‡ä»¶ç›‘è§†å™¨é›†æˆ**: æ¯«ç§’çº§æ–‡ä»¶å˜æ›´æ£€æµ‹å’Œå“åº”
- **å“ˆå¸Œæ¯”å¯¹æœºåˆ¶**: æ™ºèƒ½å˜æ›´æ£€æµ‹ï¼Œé¿å…é‡å¤å¤„ç†
- **å¢é‡å›¾æ›´æ–°**: ä»…æ›´æ–°å˜æ›´éƒ¨åˆ†ï¼Œä¿æŒå›¾ç»“æ„ä¸€è‡´æ€§
- **å¼‚æ­¥å¤„ç†é˜Ÿåˆ—**: é«˜å¹¶å‘æ–‡ä»¶å˜æ›´å¤„ç†å’Œæ™ºèƒ½é‡è¯•
- **äº‹ä»¶æ‰¹å¤„ç†**: ä¼˜åŒ–é«˜é¢‘å°æ–‡ä»¶å˜æ›´çš„æ€§èƒ½
- **çŠ¶æ€åŒæ­¥**: å®æ—¶ä¿æŒå‘é‡å­˜å‚¨å’Œå›¾æ•°æ®åº“åŒæ­¥

### æ™ºèƒ½æ€§èƒ½ä¼˜åŒ–
- **Tree-sitterè§£æä¼˜åŒ–**: è¯­æ³•æ„ŸçŸ¥åˆ†å—å’Œæ‡’åŠ è½½
- **å“ˆå¸Œå»é‡æœºåˆ¶**: é¿å…é‡å¤å¤„ç†ç›¸åŒä»£ç å—
- **æ‰¹å¤„ç†ä¼˜åŒ–**: åµŒå…¥è¯·æ±‚å’Œæ•°æ®åº“æ“ä½œçš„æ™ºèƒ½æ‰¹å¤„ç†
- **å¤šçº§ç¼“å­˜ç³»ç»Ÿ**: åµŒå…¥ç»“æœã€æœç´¢ç»“æœã€å…ƒæ•°æ®ç¼“å­˜
- **è¿æ¥æ± ç®¡ç†**: æ•°æ®åº“å’ŒAPIè¿æ¥æ± ä¼˜åŒ–
- **èµ„æºé™åˆ¶å’Œç›‘æ§**: å†…å­˜ä½¿ç”¨æ§åˆ¶å’Œèµ„æºä¿æŠ¤

### å…¨æ–¹ä½ç›‘æ§ä½“ç³»
- **PrometheusæŒ‡æ ‡æ”¶é›†**: å®æ—¶æ€§èƒ½ç›‘æ§å’ŒæŒ‡æ ‡æš´éœ²
- **æ™ºèƒ½é”™è¯¯å¤„ç†**: é”™è¯¯åˆ†ç±»ã€è‡ªåŠ¨é‡è¯•ã€æ•…éšœæ¢å¤
- **å¥åº·æ£€æŸ¥ç³»ç»Ÿ**: å¤šç»„ä»¶å¥åº·çŠ¶æ€æ£€æŸ¥å’Œå°±ç»ªæ¢é’ˆ
- **è­¦æŠ¥å’Œé€šçŸ¥**: æ™ºèƒ½è­¦æŠ¥è§„åˆ™å’Œå¤šæ¸ é“é€šçŸ¥
- **æ€§èƒ½åˆ†æ**: å“åº”æ—¶é—´ã€ååé‡ã€èµ„æºä½¿ç”¨ç›‘æ§
- **æ—¥å¿—å’Œè¿½è¸ª**: ç»“æ„åŒ–æ—¥å¿—å’Œè¯·æ±‚é“¾è·¯è¿½è¸ª

### å®‰å…¨å’Œå¯é æ€§
- **æ•°æ®åŠ å¯†**: æœ¬åœ°ç´¢å¼•æ•°æ®å’Œé€šä¿¡åŠ å¯†
- **è®¿é—®æ§åˆ¶**: åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶å’Œæƒé™ç®¡ç†
- **å®¡è®¡æ—¥å¿—**: å®Œæ•´çš„æ“ä½œè®°å½•å’Œå®‰å…¨å®¡è®¡
- **å®¹é”™æœºåˆ¶**: ç»„ä»¶éš”ç¦»å’Œæ•…éšœæ¢å¤
- **å¤‡ä»½å’Œæ¢å¤**: æ•°æ®å¤‡ä»½å’Œç¾éš¾æ¢å¤æœºåˆ¶
- **ä¾èµ–å®‰å…¨**: ä¾èµ–åŒ…å®‰å…¨æ‰«æå’Œæ›´æ–°ç®¡ç†

## ğŸ“ˆ æ‰©å±•æ€§è€ƒè™‘

### å¤šè¯­è¨€æ”¯æŒ
- **åˆå§‹æ”¯æŒ**: TypeScriptã€JavaScriptã€Pythonã€Javaã€Goã€Rustã€C/C++ã€Markdown
- **æ‰©å±•æœºåˆ¶**: Tree-sitterè§£æå™¨æ’ä»¶ç³»ç»Ÿï¼Œæ”¯æŒæ–°è¯­è¨€å¿«é€Ÿé›†æˆ
- **è¯­è¨€ç‰¹å®šè§„åˆ™**: æ¯ç§è¯­è¨€çš„ä¸“ç”¨è§£æè§„åˆ™å’Œæ¨¡å¼è¯†åˆ«
- **è·¨è¯­è¨€åˆ†æ**: å¤šè¯­è¨€é¡¹ç›®çš„ç»Ÿä¸€åˆ†æå’Œä¾èµ–è¿½è¸ª

### åˆ†å¸ƒå¼å¤„ç†
- **å¤§è§„æ¨¡ä»£ç åº“æ”¯æŒ**: åˆ†å¸ƒå¼å›¾æ•°æ®åº“å’Œå‘é‡å­˜å‚¨é›†ç¾¤
- **å¤šçº¿ç¨‹/å¤šè¿›ç¨‹è§£æ**: å¹¶è¡Œæ–‡ä»¶å¤„ç†å’Œæ™ºèƒ½ä»»åŠ¡è°ƒåº¦
- **å¾®æœåŠ¡æ¶æ„**: å„ç»„ä»¶ç‹¬ç«‹éƒ¨ç½²å’Œæ°´å¹³æ‰©å±•
- **è´Ÿè½½å‡è¡¡**: æ™ºèƒ½è´Ÿè½½åˆ†é…å’Œæ•…éšœè½¬ç§»

### å®æ—¶æ›´æ–°å’Œç‰ˆæœ¬æ§åˆ¶
- **Gité›†æˆ**: ç‰ˆæœ¬æ§åˆ¶å’Œå˜æ›´å†å²è¿½è¸ª
- **åˆ†æ”¯ç®¡ç†**: å¤šåˆ†æ”¯ä»£ç åº“çš„å¹¶è¡Œåˆ†æ
- **å˜æ›´å½±å“åˆ†æ**: åŸºäºGitçš„ä»£ç å˜æ›´å½±å“è¯„ä¼°
- **æ—¶é—´æœºå™¨**: å†å²ä»£ç ç»“æ„çš„æ—¶åºåˆ†æå’Œæ¯”è¾ƒ

### æ™ºèƒ½åŒ–å’Œæœºå™¨å­¦ä¹ 
- **ä»£ç è´¨é‡è¯„ä¼°**: åŸºäºæœºå™¨å­¦ä¹ çš„ä»£ç è´¨é‡åˆ†æ
- **æ¨¡å¼è¯†åˆ«**: ä»£ç æ¨¡å¼å’Œåæ¨¡å¼è‡ªåŠ¨è¯†åˆ«
- **æ™ºèƒ½æ¨è**: åŸºäºä»£ç ç»“æ„çš„é‡æ„å»ºè®®
- **å¼‚å¸¸æ£€æµ‹**: ä»£ç å¼‚å¸¸å’Œæ½œåœ¨é—®é¢˜çš„æ™ºèƒ½è¯†åˆ«

## ğŸ”— ä¸å‘é‡æœç´¢é›†æˆ

### æ·±åº¦æ•°æ®å…³è”
- **å›¾èŠ‚ç‚¹å‘é‡åŒ–**: å›¾èŠ‚ç‚¹å’Œå…³ç³»çš„è¯­ä¹‰å‘é‡åŒ–
- **å‘é‡-å›¾å…³è”**: å‘é‡æœç´¢ç»“æœä¸å›¾å…³ç³»çš„æ™ºèƒ½å…³è”
- **å¤šæ¨¡æ€æœç´¢**: ç»“åˆè¯­ä¹‰æœç´¢å’Œå›¾ç»“æ„æŸ¥è¯¢
- **ä¸Šä¸‹æ–‡å¢å¼º**: åŸºäºè°ƒç”¨å…³ç³»çš„è¯­ä¹‰æœç´¢ä¸Šä¸‹æ–‡

### æ™ºèƒ½æœç´¢å¢å¼º
- **æ··åˆæŸ¥è¯¢å¼•æ“**: ç»Ÿä¸€çš„è¯­ä¹‰æœç´¢å’Œå›¾æŸ¥è¯¢æ¥å£
- **ç›¸å…³æ€§ä¼˜åŒ–**: å¤šç»´åº¦è¯„åˆ†å’Œæ™ºèƒ½ç»“æœé‡æ’
- **æŸ¥è¯¢ç†è§£**: è‡ªç„¶è¯­è¨€æŸ¥è¯¢åˆ°ç»“æ„åŒ–æŸ¥è¯¢çš„è½¬æ¢
- **ä¸ªæ€§åŒ–æœç´¢**: åŸºäºç”¨æˆ·è¡Œä¸ºå’Œé¡¹ç›®ç‰¹å¾çš„ä¸ªæ€§åŒ–ç»“æœ

### æ€§èƒ½æŒ‡æ ‡å’Œç›‘æ§

#### æ ¸å¿ƒæ€§èƒ½æŒ‡æ ‡
- **æœç´¢å“åº”æ—¶é—´**: <200ms (P95) - æå‡60%
- **ç´¢å¼•å¤„ç†é€Ÿåº¦**: >500æ–‡ä»¶/åˆ†é’Ÿ - æå‡40%
- **å†…å­˜ä½¿ç”¨**: <400MBå¸¸é©»å†…å­˜ - é™ä½20%
- **é”™è¯¯ç‡**: <0.1%è¯·æ±‚å¤±è´¥
- **å¯ç”¨æ€§**: 99.9%æœåŠ¡æ­£å¸¸è¿è¡Œæ—¶é—´

#### ç›‘æ§æŒ‡æ ‡
- **è§£ææ€§èƒ½**: ä»£ç è§£æé€Ÿåº¦å’Œå‡†ç¡®ç‡
- **åµŒå…¥ç”Ÿæˆ**: åµŒå…¥APIè°ƒç”¨æˆåŠŸç‡å’Œå»¶è¿Ÿ
- **æ•°æ®åº“æ€§èƒ½**: Neo4jå’ŒQdrantæŸ¥è¯¢æ€§èƒ½
- **ç³»ç»Ÿèµ„æº**: CPUã€å†…å­˜ã€ç£ç›˜IOä½¿ç”¨ç‡
- **ä¸šåŠ¡æŒ‡æ ‡**: æœç´¢ç»“æœç›¸å…³æ€§å’Œç”¨æˆ·æ»¡æ„åº¦

#### è­¦æŠ¥è§„åˆ™
- **æ€§èƒ½è­¦æŠ¥**: å“åº”æ—¶é—´è¶…é˜ˆå€¼ã€é”™è¯¯ç‡å¼‚å¸¸
- **èµ„æºè­¦æŠ¥**: å†…å­˜æ³„æ¼ã€ç£ç›˜ç©ºé—´ä¸è¶³
- **ä¸šåŠ¡è­¦æŠ¥**: æœç´¢ç»“æœè´¨é‡ä¸‹é™ã€ç”¨æˆ·åé¦ˆå¼‚å¸¸
- **ç³»ç»Ÿè­¦æŠ¥**: æœåŠ¡ä¸å¯ç”¨ã€ä¾èµ–æœåŠ¡å¼‚å¸¸

## ğŸ“Š å®æ–½è·¯çº¿å›¾

### ç¬¬ä¸€é˜¶æ®µ: æ ¸å¿ƒæ¶æ„æ­å»º (3-4å‘¨)
1. âœ… æ™ºèƒ½ä»£ç è§£æå™¨é›†æˆ (Tree-sitter)
2. âœ… å¤šåµŒå…¥å™¨æ”¯æŒæ¡†æ¶
3. ğŸ”„ å›¾æ•°æ®åº“åŸºç¡€æ¶æ„
4. ğŸ”„ å‘é‡æ•°æ®åº“é›†æˆ
5. â¬œ åŸºç¡€ç›‘æ§å’Œé”™è¯¯å¤„ç†

### ç¬¬äºŒé˜¶æ®µ: åŠŸèƒ½å¢å¼º (2-3å‘¨)
1. ğŸ”„ è¯­ä¹‰æœç´¢å¢å¼º
2. ğŸ”„ å¢é‡ç´¢å¼•å®ç°
3. â¬œ æ™ºèƒ½æŸ¥è¯¢åŠŸèƒ½
4. â¬œ å¯è§†åŒ–ç•Œé¢
5. â¬œ æ€§èƒ½ä¼˜åŒ–

### ç¬¬ä¸‰é˜¶æ®µ: ç”Ÿäº§å°±ç»ª (2-3å‘¨)
1. â¬œ å…¨æ–¹ä½ç›‘æ§ç³»ç»Ÿ
2. â¬œ å®‰å…¨å’Œæƒé™ç®¡ç†
3. â¬œ å¤‡ä»½å’Œæ¢å¤æœºåˆ¶
4. â¬œ æ€§èƒ½æµ‹è¯•å’Œè°ƒä¼˜
5. â¬œ æ–‡æ¡£å’Œéƒ¨ç½²æŒ‡å—

### ç¬¬å››é˜¶æ®µ: é«˜çº§ç‰¹æ€§ (2-3å‘¨)
1. â¬œ åˆ†å¸ƒå¼å¤„ç†æ”¯æŒ
2. â¬œ Gité›†æˆå’Œç‰ˆæœ¬æ§åˆ¶
3. â¬œ æ™ºèƒ½åˆ†æå’Œæ¨è
4. â¬œ å¤šè¯­è¨€æ‰©å±•
5. â¬œ äº‘åŸç”Ÿéƒ¨ç½²

---

*æœ€åæ›´æ–°: 2025-01-27*  
*ç‰ˆæœ¬: v2.0.0*  
*çŠ¶æ€: æ¶æ„å¢å¼ºå®Œæˆ - åŸºäºKiloCodeè®¾è®¡æ€æƒ³ä¼˜åŒ–*

**æ ¸å¿ƒæ”¹è¿›äº®ç‚¹**:
- ğŸ¯ **æ™ºèƒ½ä»£ç è§£æ**: Tree-sitterå¤šè¯­è¨€è¯­æ³•æ„ŸçŸ¥åˆ†å—
- ğŸ” **å¤šåµŒå…¥å™¨æ”¯æŒ**: ç»Ÿä¸€æ¥å£æ”¯æŒOpenAIã€Ollamaã€Geminiã€Mistral
- ğŸ“Š **è·¯å¾„æ®µç´¢å¼•**: ç²¾ç¡®ç›®å½•çº§è¿‡æ»¤å’Œæ–‡ä»¶çº§æ“ä½œ
- âš¡ **å¢é‡å®æ—¶ç´¢å¼•**: æ–‡ä»¶ç›‘è§†å™¨æ”¯æŒçš„æ¯«ç§’çº§å˜æ›´å“åº”
- ğŸ“ˆ **å…¨æ–¹ä½ç›‘æ§**: PrometheusæŒ‡æ ‡æ”¶é›†å’Œæ™ºèƒ½é”™è¯¯å¤„ç†

**ä¸‹ä¸€æ­¥**: å¼€å§‹å®æ–½ç¬¬ä¸€é˜¶æ®µçš„æ ¸å¿ƒæ¶æ„æ­å»º