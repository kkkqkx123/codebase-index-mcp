rules:
  - id: concurrency-deadlock-detection
    message: "Deadlock detection rules"
    languages: [java]
    severity: ERROR
    pattern-regex: .*semgrep.*
    metadata:
      category: concurrency
      technology: [deadlock, synchronization]
      references:
        - https://docs.oracle.com/javase/tutorial/essential/concurrency/deadlock.html

  - id: concurrency-race-condition-detection
    message: "Race condition detection rules"
    languages: [java, javascript, typescript, python]
    severity: ERROR
    pattern-regex: .*semgrep.*
    metadata:
      category: concurrency
      technology: [race-condition, multithreading]
      references:
        - https://docs.oracle.com/javase/tutorial/essential/concurrency/race.html

  - id: enhanced-race-condition-detection
    message: "Enhanced race condition detection rules"
    languages: [java, javascript, typescript, python]
    severity: ERROR
    pattern-regex: ".*"
    metadata:
      file: enhanced-race-condition-detection.yml
      description: "Enhanced detection of race conditions including shared variables, maps, counters, file access, and resource pools"
      category: concurrency
      technology: [multithreading, race-conditions, shared-variables, resource-pools]

  - id: multi-language-race-condition-detection
    message: "Multi-language race condition detection rules"
    languages: [java, javascript, typescript, python]
    severity: ERROR
    pattern-regex: ".*"
    metadata:
      file: multi-language-race-condition-detection.yml
      description: "Comprehensive race condition detection for Java, Python, JavaScript, and TypeScript with language-specific patterns"
      category: concurrency
      technology: [multithreading, race-conditions, shared-variables, collections, file-access, async-operations]

  - id: concurrency-thread-safety-issues
    message: "Thread safety issue detection rules"
    languages: [java]
    severity: ERROR
    pattern-regex: .*semgrep.*
    metadata:
      category: concurrency
      technology: [thread-safety, java-util]
      references:
        - https://docs.oracle.com/javase/tutorial/essential/concurrency/sync.html

  - id: concurrency-best-practices
    message: "Concurrency best practices rules"
    languages: [java, javascript, typescript]
    severity: INFO
    pattern-regex: .*semgrep.*
    metadata:
      category: concurrency
      technology: [best-practices, concurrency-utilities]
      references:
        - https://docs.oracle.com/javase/tutorial/essential/concurrency/highlevel.html

  - id: concurrency-async-programming-issues
    message: "Async programming issue detection rules"
    languages: [java, javascript, typescript]
    severity: WARNING
    pattern-regex: .*semgrep.*
    metadata:
      category: concurrency
      technology: [async, futures, promises]
      references:
        - https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/package-summary.html