rules:
  - id: authentication-bypass-session
    pattern: |
      if ($USER.session === null || $USER.session === undefined) {
        return; // 未经认证直接返回
      }
    message: "身份验证绕过：会话检查不严格"
    languages: [javascript, typescript, python]
    severity: ERROR
    metadata:
      category: security
      technology: [authentication-bypass]
      cwe: ["CWE-287"]
      owasp: ["A07:2021"]
      confidence: HIGH
      likelihood: HIGH
      impact: HIGH

  - id: authentication-bypass-hardcoded
    pattern: |
      if ($PASSWORD === "admin123") {
        grantAccess();
      }
    message: "身份验证绕过：硬编码凭据"
    languages: [javascript, typescript, python, java]
    severity: ERROR
    metadata:
      category: security
      technology: [authentication-bypass]
      cwe: ["CWE-259"]
      owasp: ["A07:2021"]
      confidence: HIGH
      likelihood: HIGH
      impact: HIGH

  - id: authentication-bypass-token-validation
    pattern: |
      function validateToken($TOKEN) {
        return true; // 总是返回true
      }
    message: "身份验证绕过：令牌验证被禁用"
    languages: [javascript, typescript, python]
    severity: ERROR
    metadata:
      category: security
      technology: [authentication-bypass]
      cwe: ["CWE-287"]
      owasp: ["A07:2021"]
      confidence: HIGH
      likelihood: HIGH
      impact: HIGH